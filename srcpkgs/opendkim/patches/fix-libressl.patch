diff --git a/opendkim/opendkim-crypto.c b/opendkim/opendkim-crypto.c
index af0f897d..534eb2e0 100644
--- opendkim/opendkim-crypto.c
+++ opendkim/opendkim-crypto.c
@@ -221,7 +221,7 @@ dkimf_crypto_free_id(void *ptr)
 	{
 		assert(pthread_setspecific(id_key, ptr) == 0);
 
-#if OPENSSL_VERSION_NUMBER >= 0x10100000
+#if OPENSSL_VERSION_NUMBER >= 0x10100000 && !defined(LIBRESSL_VERSION_NUMBER)
 		OPENSSL_thread_stop();
 #else
 		ERR_remove_state(0);
@@ -361,10 +361,10 @@ dkimf_crypto_init(void)
 		return status;
 
 	SSL_load_error_strings();
-#if OPENSSL_VERSION_NUMBER < 0x10100000L
-	SSL_library_init();
-#else /* OPENSSL_VERSION_NUMBER < 0x10100000L */
+#if OPENSSL_VERSION_NUMBER >= 0x10100000 && !defined(LIBRESSL_VERSION_NUMBER)
 	OPENSSL_init_ssl(0, NULL);
+#else /* OPENSSL_VERSION_NUMBER < 0x10100000L */
+	SSL_library_init();
 #endif /* OPENSSL_VERSION_NUMBER < 0x10100000L */
 	ERR_load_crypto_strings();
 
@@ -399,7 +399,7 @@ dkimf_crypto_free(void)
 {
 	if (crypto_init_done)
 	{
-#if OPENSSL_VERSION_NUMBER >= 0x10100000
+#if OPENSSL_VERSION_NUMBER >= 0x10100000 && !defined(LIBRESSL_VERSION_NUMBER)
 		OPENSSL_thread_stop();
 #else
 		CRYPTO_cleanup_all_ex_data();
